<%-include('../layouts/websitehead.ejs')%>
<body>
    <!-- Topbar Start -->
    <div class="container-fluid bg-dark mb-30">
        <div class="row px-xl-5">
            <div class="col-lg-3 d-none d-lg-block">
                <a class="btn d-flex align-items-center justify-content-between  w-100" data-toggle="collapse" href="#navbar-vertical" style="height: 65px; padding: 0 30px;">
                    <h6 class="text-white m-0"><i class="fa fa-bars mr-2"></i>Categories</h6>
                    <i class="fa fa-angle-down text-white"></i>
                </a>
                <nav class="collapse position-absolute navbar navbar-vertical navbar-light align-items-start p-0 bg-light" id="navbar-vertical" style="width: calc(100% - 30px); z-index: 999;">
                    <div class="navbar-nav w-100">
                       <% for(let i=0 ;i<categoryData.length ;i++){%>
                            <a href="/shop?id=<%= categoryData[i]._id %>" class="nav-item nav-link"><%= categoryData[i].name%></a>
                      <% } %>

                        
                        
                    </div>
                </nav>
            </div>
            <div class="col-lg-9">
                <nav class="navbar navbar-expand-lg bg-dark navbar-dark py-3 py-lg-0 px-0">
                    <a href="" class="text-decoration-none d-block d-lg-none">
                        <span class="h2 text-dark bg-light px-2">Lap</span>
                        <span class="h1 text-uppercase text-light bg-primary px-2 ml-n1">Mania</span>
                    </a>
                    <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbarCollapse">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse justify-content-between" id="navbarCollapse">
                        <div class="navbar-nav mr-auto py-0">
                            <a href="/home  " class="nav-item nav-link active">Home</a>
                            <a href="/shop" class="nav-item nav-link">Shop</a>
                            <!-- <a href="/detail" class="nav-item nav-link">Shop Detail</a> -->
                            
                            <a href="contact.html" class="nav-item nav-link">Contact</a>
                        </div>
                        <div class="navbar-nav ml-auto py-0 d-none d-lg-block">
                            <a href="/profile" class="btn me-4 ">
                                <% if(typeof userData !== 'undefined'){%>
                                        <p class="text-uppercase text-white pt-3 px-4"><%=userData.name%></p>
                               <% } %>
                               
                                
                            </a>
                            <% if(typeof userData !== 'undefined'){%>
                               <a href="/wishlist" class="btn px-0">
                                                                <i class="fas fa-heart text-primary"></i>
                                                                <span class="badge text-secondary border border-secondary rounded-circle" style="padding-bottom: 2px;"><%=wishlistCount%></span>
                                                               
                                                                </a>
                                                            <a href="/cart" class="btn px-0 ml-3">
                                                                <i class="fas fa-shopping-cart text-warning"></i>
                                                                <span class="badge text-secondary border border-secondary rounded-circle" style="padding-bottom: 2px;"><%=cartCount%></span>
                                                                <!-- <span class="cart-badge text-white " style="font-size: small; padding-top: 10px;"><%=cartCount%></span> -->
                                                                
                                                                </a>
                                                               


                        <% }else{%>

                            <a href="/login" class="btn px-0" >
                                <i class="fas fa-heart text-primary"></i>
                                </a>
                            <a href="/login" class="btn px-0 ml-3">
                                <i class="fas fa-shopping-cart text-primary"></i>
                                </a>
        

                       <% } %>
                            
                        </div>
                    </div>
                </nav>
            </div>
        </div>
    </div>
    <style>@import url('https://fonts.googleapis.com/css?family=Open+Sans&display=swap');body{background-color: #eeeeee;font-family: 'Open Sans',serif}.container{margin-top:50px;margin-bottom: 50px}.card{position: relative;display: -webkit-box;display: -ms-flexbox;display: flex;-webkit-box-orient: vertical;-webkit-box-direction: normal;-ms-flex-direction: column;flex-direction: column;min-width: 0;word-wrap: break-word;background-color: #fff;background-clip: border-box;border: 1px solid rgba(0, 0, 0, 0.1);border-radius: 0.10rem}.card-header:first-child{border-radius: calc(0.37rem - 1px) calc(0.37rem - 1px) 0 0}.card-header{padding: 0.75rem 1.25rem;margin-bottom: 0;background-color: #fff;border-bottom: 1px solid rgba(0, 0, 0, 0.1)}.track{position: relative;background-color: #ddd;height: 7px;display: -webkit-box;display: -ms-flexbox;display: flex;margin-bottom: 60px;margin-top: 50px}.track .step{-webkit-box-flex: 1;-ms-flex-positive: 1;flex-grow: 1;width: 25%;margin-top: -18px;text-align: center;position: relative}.track .step.active:before {background: #26a541}.track .step::before{height: 7px;position: absolute;content: "";width: 100%;left: 0;top: 18px}.track .step.active .icon{background: #2874f0;color: #fff}.track .icon{display: inline-block;width: 40px;height: 40px;line-height: 40px;position: relative;border-radius: 100%;background: #ddd}.track .step.active .text{font-weight: 400;color: #000}.track .text{display: block;margin-top: 7px}.itemside{position: relative;display: -webkit-box;display: -ms-flexbox;display: flex;width: 100%}.itemside .aside{position: relative;-ms-flex-negative: 0;flex-shrink: 0}.img-sm{width: 80px;height: 80px;padding: 7px}ul.row, ul.row-sm{list-style: none;padding: 0}.itemside .info{padding-left: 15px;padding-right: 7px}.itemside .title{display: block;margin-bottom: 5px;color: #212529}p{margin-top: 0;margin-bottom: 1rem}.btn-warning{color: #ffffff;background-color: #ee5435;border-color: #ee5435;border-radius: 1px}.btn-warning:hover{color: #ffffff;background-color: #ff2b00;border-color: #ff2b00;border-radius: 1px}</style>
    <div class="container">
        <article class="card">
            <header class="card-header"> My Orders / Tracking </header>
            <div class="card-body">
                <h6>Order ID:<%=orderData._id%></h6>
                <article class="card">
                    <div class="card-body row " style="color: #3D464D;">
                        <div class="col"> <strong>Estimated Delivery time:</strong> <br><%=orderData.deliveryDate%></div>
                        <div class="col"> <strong>Shipping BY:</strong> <br> BLUEDART, | <i class="fa fa-phone"></i> +1598675986 </div>
                        <div class="col"> <strong>Status:</strong> <br> Picked by the courier </div>
                        <div class="col"> <strong>Delivery Address:</strong> <br> <%=address%> </div>
                    </div>
                </article>
                <div class="track">
                    <% if(orderData.orderStatus =='Placed'){%>
                    <div class="step active"><span class="icon"><i class="fa fa-check"></i></span> <span class="text">Order confirmed</span></div>
                    <div class="step"> <span class="icon"> <i class="fa fa-user"></i> </span> <span class="text"> Shipped</span> </div>
                    <div class="step"> <span class="icon"> <i class="fa fa-truck"></i> </span> <span class="text"> Out For Delivery</span> </div>
                    <div class="step"> <span class="icon"> <i class="fa fa-box"></i> </span> <span class="text">Delivered</span> </div>
              
                    <% }else if(orderData.orderStatus == 'Shipped'){%>
                        <div class="step active"> <span class="icon"> <i class="fa fa-check"></i> </span> <span class="text">Order confirmed</span> </div>
                        <div class="step active"> <span class="icon"> <i class="fa fa-user"></i> </span> <span class="text"> Shipped</span> </div>
                        <div class="step"> <span class="icon"> <i class="fa fa-truck"></i> </span> <span class="text"> Out For Delivery</span> </div>
                        <div class="step"> <span class="icon"> <i class="fa fa-box"></i> </span> <span class="text">Delivered</span> </div>
                    <% }else if(orderData.orderStatus == 'Out for Delivery'){%>
                    <div class="step active"> <span class="icon"> <i class="fa fa-check"></i> </span> <span class="text">Order confirmed</span> </div>
                    <div class="step active"> <span class="icon"> <i class="fa fa-user"></i> </span> <span class="text"> Shipped</span> </div>
                    <div class="step active"> <span class="icon"> <i class="fa fa-truck"></i> </span> <span class="text"> Out For Delivery</span> </div>
                    <div class="step"> <span class="icon"> <i class="fa fa-box"></i> </span> <span class="text">Delivered</span> </div>
                <% }else if(orderData.orderStatus == 'Delivered'){%>
                <div class="step active"> <span class="icon"> <i class="fa fa-check"></i> </span> <span class="text">Order confirmed</span> </div>
                <div class="step active"> <span class="icon"> <i class="fa fa-user"></i> </span> <span class="text"> Shipped</span> </div>
                <div class="step active"> <span class="icon"> <i class="fa fa-truck"></i> </span> <span class="text"> Out For Delivery</span> </div>
                <div class="step active"> <span class="icon"> <i class="fa fa-box"></i> </span> <span class="text">Delivered</span> </div>
                <%}else if(orderData.orderStatus =='Cancelled'){%>
                    <div class="step active"> <span class="icon text-danger"> <i class="fa fa-check"></i> </span> <span class="text">Order confirmed</span> </div>
                    <div class="step active">  <i class=""></i> </span> <span class="text"> </span> </div>
                    <div class="step active">  <i class=""></i> </span> <span class="text"></span> </div>
                    <div class="step active"> <span class="icon text-danger  "> <i class="fa fa-times" ></i> </span> <span class="text" style="color: red;">Cancelled</span> </div>
              
                <%}%>
                </div>
                <hr>
                
                    <% for (let i=0;i<orderData.products.length;i++){%>
                        <div class="row">
                    <div class="col-12">
                        <figure class="itemside mb-3 ">
                            

                            
                            <div class=""><img  src="/productImages/<%=orderData.products[i].productId[0].image[0] %>" class="img-sm "></div>
                            <figcaption class="info ">
                                <p class="title "><%=orderData.products[i].productId[0].name%> <br><span class="text-muted"> Qty:</span> <%=orderData.products[i].quantity%><br> </p> <span class="text-dark" style="font-weight: 600;" >&#x20B9;<%=orderData.products[i].price%> </span>
                            </figcaption>
                       
                        </figure>
                    </div>
                      </div> 
                      <hr>
                    <%}%>

              
                
                <a href="/orderlist" class="btn btn-warning" style="background-color: #2874f0; border: none;"  data-abc="true"> <i class="fa fa-chevron-left" ></i> Back to orders</a>
               <% if(orderData.orderStatus =='Cancelled'||orderData.orderStatus =='Delivered'){%>
                 <%}else{%>
                <button type="submit" onclick="myFunction()" style="background-color: red;" class="btn  float-right text-white">Cancel Order</button>
                
                <%}%>

                </div>
        </article>
    </div>



    <script>
  
  function myFunction() {
	
    Swal.fire({
      title: 'Are you sure?',
      text: "You won't be able to revert this!",
      icon: 'warning',
      showCancelButton: true,
      confirmButtonColor: '#3085d6',
      cancelButtonColor: '#d33',
      confirmButtonText: 'Yes, confirm!'
    }).then((result) => {
      if (result.value) {
        window.location.href = '/orderCancel?id=<%=orderData._id%>';
      }
    })
  }
      
      </script>

</script>

  
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

    
<%-include('../layouts/websitefooter.ejs')%>